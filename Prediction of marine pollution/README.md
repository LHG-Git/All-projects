<div align="center">
  <h1>📝 개인 프로젝트<br><br>
  🚢 해양정보를 활용한 해양오염 예측</h1>
</div>
<h3>💭 분석툴 : Google Colab, Pandas, Numpy, Matplotlib, QGIS, Sklearn, scipy<br><br>
    📅 진행기간 : 2023.03.23 ~ 2023.06.07</h3>

### 👨‍👦‍👦 팀원소개
<table>
<tbody>
  <tr>
    <td align="left"><img src="" width="20px;" alt=""/><br /><b>팀원 : 이희구</b></a><br /></td>
   <tr/>
</tbody>
</table>
<br>
<h3 align="center"><img src="https://github.com/LHG-Git/project/assets/100845169/404d4b3a-ac36-4533-823b-c6280df58817" height = 600px></h3>


# 🔊 프로젝트 개요
* 해양 환경의 오염률이 꾸준히 상승세 유지<br>
* 해양 오염이 해양 생태계를 교란시키고, 이는 해양 생물의 떼죽음 현상을 야기<br>
* 해양 오염 방지를 위한 정책은 과거의 데이터만으로 수질관리 계획을 수립한다는 한계점<br>
* 정부는 해양 오염의 심각성이 우려되는 해안을 '환경관리해역'으로 선정하여 오염물질의 총량을 규제하는 방식으로 관리하는 등 다양한 <br>정책 도입
<br><br>

# 💡 분석 기획
* 해양오염지수를 예측하고, 해양오염 문제를 미리 예방에 일조<br>
* 2019~2020년 약 2년치의 해양환경측정 데이터를 활용하여 분석, EDA, 모델링 및 예측 수행, 프로젝트의 전체적인 흐름 및 아키텍처 구상<br>
* 통계 분석, 머신러닝 등 다양한 분석 방법을 활용하여 해양오염지수 예측<br><br>
<br>

# 🔥 목적 및 필요성
* 해양 환경 보호의 중요성
> 해양은 지구 생태계의 중요한 구성 요소 중 하나에 해당, 하지만 인간 산업 및 생활 활동으로 인해 해양 환경은 지속적으로 오염되고 있는 실정
* 해양오염 예측을 통한 해양 환경 모니터링의 중요성
> 화학적 산소농도(COD) 예측을 통해 해양 환경 변화를 예측할 수 있고, 예측 결과를 토대로 해양환경 보호 가능
* 환경관리해역 설정의 필요성
> 정부는 해양오염의 심각성이 우려되는 해안을 따로 선별하여 오염물질의 총량을 규제하는 정책 도입,<br> 
> 특정 지역의 생태계 보호가 가능하고, 해양 생태계의 전반적인 건강 상태 유지가능
<br>


# 🔎 데이터 수집
|데이터셋|출처|
|------|:------:|
|해양환경측정망 데이터|관할해역해양정보 공동활용시스템|
|국가 해양생태계 데이터|해양환경공단|
|갯끈풀 위치 데이터|네이처링|
|바다 격자 정보(격자 3단계)shp 데이터|바다누리 해양정보 플랫폼|
|갯벌 현황도 shp데이터|해양수산부 연안 포털|

<br>


# 🔎 데이터 전처리
|전처리|방법|
|------|:-------------:|
|QGIS를 이용한 데이터 매핑|value값이 처음부터 끝까지 동일한 feature를 삭제|
|결측치 제거|전체 행 대비 결측치 비율이 30%가 넘어가는 컬럼을 삭제|
|데이터 정규화(MinMaxScaler)|해양 화학물질의 경우 MinMaxScaler를 이용|
|동해 관측소 삭제|모두 동일한 화학적 산소 농도 값을 모델링 과적합 방지를 위해 삭제|
|불필요한 컬럼 삭제|상관관계 값이 0.15미만에 해당하는 컬럼들은 전부 삭제|
|차원축소(PCA)|변수중요도가 낮게 측정된 두 개의 feature에 PCA를 적용|
|중복 데이터 처리|정선해양관측 데이터와 해양환경관측 데이터의 중복 컬럼 처리|

<br><br>

# 🔎 QGIS를 이용한 데이터 매핑
## 1) 관측소 및 갯끈풀 위치 시각화
<h3 align="center"><img src="https://github.com/LHG-Git/project/assets/100845169/975134d4-1675-4212-baba-3a9cb8ccc6ca"></h3> <br>

* 위의 그림과 같이, 비슷한 구역에 관측소가 붙어있는 것을 확인할 수 있음
* 이런 경우 바다 격자 정보를 이용하여 해안 구역을 설정한 뒤, 한 격자에 들어오는 관측소는 하나의 관측소로 통합 시킬 것을 고려함
## 2) 바다 격자 정보 세분화
<h3 align="center"><img src="https://github.com/LHG-Git/project/assets/100845169/ba90ffbf-2929-4e95-8125-999aaffb2da7"></h3> <br>

* 한 격자내에 속해있는 관측소는 하나의 관측소로 간주하기 위한 작업
* 수집한 격자정보의 경우 3단계 격자 정보에 해당하였고, 3단계의 정보를 이용하여 해안 구역을 선정할 경우 반경 범위가 상당히 광범위했기 때문에 구체적인 지역 선정이 어렵다고 판단하여, 더 세분화하기 위한 작업인 4단계 격자로 지역을 나누는 작업 진행
## 3) 역거리 가중 보간법(IDW)을 이용한 최종 데이터셋 구성
<h3 align="center"><img src="https://github.com/LHG-Git/project/assets/100845169/8f13da25-2da7-40e4-93e7-aef89819b09e"></h3> <br>

* 해양환경측정망, 해양생태계 데이터와 갯끈풀의 위치 속성을 QGIS에 표시
* 표시된 각 포인트 지점 사이에 비어있는 사이값을 구하기 위하여, 공간보간법을 사용할 것을 고려
* 특정 포인트와 속성값을 이용하여 연속적인 공간의 속성값을 도출하여, 한 격자내에 포함된 포인트는 하나의 관측소로 매핑하고자 하였고, 이때 공간보간법중 하나인 역거리 가중 보간법(IDW)를 활용
* 포인트 및 속성별 연속적인 래스터 데이터를 생성한 뒤 벡터로 변환하여, 이전에 세분화시킨 4단계 격자에 벡터 데이터를 할당
* 그 후, 작게 분할된 벡터 데이터의 변수들을 평균값을 취해 격자별 관측소 및 갯끈풀 속성 데이터를 생성하여 최종데이터셋을 완성

<br>

# 📊 EDA(탐색적 데이터 분석)
## 1) 상관관계 분석
* feature간의 상관관계가 높은 경우가 있어, 다중공선성이 우려<br>

* 추후 상관계수가 높은 각 입력 변수를 제거/추가하며 회귀계수의 변동정도 파악, 차원축소 PCA 적용, 정규화, VIF(Variance Inflation     Factor)를 이용한 변수선택 등 다양한 방법론을 적용시킬 것을 고려<br>

* 상관관계 분석 시각화를 통해 target값인 화학적 산소농도와 상관관계 값이 0.15미만에 해당하는 컬럼은 전부 삭제를 진행<br>



## 2) 관측소별 화학적 산소농도 차이 시각화
<h3 align="center"><img src= https://github.com/LHG-Git/project/assets/100845169/bd886e2d-e5a1-4a7a-b1ec-13661f8a267e></h3>
* 동해에 위치한 모든 관측치에서는 화학적 산소농도값이 정상범위(약 1.0)을 기록

* 서해의 논산과 인천부근 그리고 남해의 부산과 창원부근의 관측치에서는 정상 수치보다 높은 화학적 산소 농도값이 기록된 것을 통해 화학적 산소농도 값이 위치적 특성에 따라 영향을 받는다는 것을 확인

<br><br>
# 📄 Modeling
## 1) 군집화
<h3 align="center"><img src= https://github.com/LHG-Git/project/assets/100845169/fa2574f6-a8b8-418f-be42-6d010ce75528></h3>
* 최적의 k값 도출을 위해 <strong>실루엣 계수</strong>를 사용<br> 
* 이때 실루엣 계수 평균만을 고려하지 않았고 figure6을 통해 도출된 인사이트를 함께 고려<br>
* 그 결과 cluster별 실루엣 계수 평균이 가장 높지는 않지만, 실루엣 계수의 너비가 비교적 균일한 지점에서 최적의 k(k=6)값을 도출<br><br>

<h3 align="center"><img src= https://github.com/LHG-Git/project/assets/100845169/3c91929c-c2b1-4531-a199-5ea753d1caf1></h3>
* 최적의 K값을 통해 위치별 군집화 결과, figure 7에서 인천 부근의 서해에 위치한 관측치와, 부산 부근의 남해에 위치한 관측치에서 화학적 산소농도 수치가 높게 기록
## 2) ANOVA검정
* EDA 및 분석을 통해 사용하고자 하는 변수가 승하차 인원 값에 미치는 영향이 <strong>통계적으로 유의한지 확인하기 위해 진행</strong><br><br><br>


## 3) 변수선정
|변수선정|변수|
|:------:|---|
|공통변수|노선명, 버스정류장 개수, 노선수, 계절, 기온, 공원 개수, 요일, 휴일여부, 누적휴일, 1일우량, 량|
|상업그룹 변수|산업, 숙박/음식, 레저/관광/예술, 영화관 개수, 백화점 개수|
|업무주거그룹 변수|행정, 대학생 수, 학생 수(중,고등), 교육/보건, 중소기업 개수|<br><br>

## 4) Hold-Out 검정
* <strong>Lidge, Lasso, RandomForest, Xgboost, DecisionTree, LightGBM</strong> 등 여러 회귀분석 모델들 중 모델 선정을 위한 <strong>Hold-Out 검정</strong>을 진행<br>
* 그 결과, <strong>9호선 신설역 수요 예측에 LightGBM 모델이 가장 적합할 것이라 판단하여 진행</strong><br><br><br>

## 5) LightGBM
#### <strong>LightGBM 모델을 통한 승하차수 예측</strong>,<strong>평균 절대 오차값인 MAE값을 통한 모델 성능 검증</strong><br><br>
<h3 align="center"><img src="https://github.com/heegu0513/project/assets/100845169/91536d1e-30f3-45e7-a484-fee82143c46d" width = 500px height = 300px></h3>

#### (1차) : 파라미터 조정 및 k-fold 교차검증을 이용하지 않고, LightGBM 모델의 default값 그대로 초기 예측을 진행 

* <strong>상업그룹의 MAE : 2600명, 업무주거그룹의 MAE값 : 2100명</strong><br><br>
<h3 align="center"><img src="https://github.com/heegu0513/project/assets/100845169/75eb31da-8e09-48fc-b275-3b51a0852dee" width = 500px height = 300px></h3>

#### (2차) : 하이퍼 파라미터 튜닝을 통해 최적의 파라미터 값을 지정 및 5차 k-fold를 이용하여 노이즈 값을 최소화한 후 예측을 진행


* <strong>상업그룹의 MAE값이 1500명, 업무주거그룹의 MAE값 990명<br>
  
### 결론 : 오차 값이 1000~1100명 정도 감소하여 성능이 향상 👍<br><br>

## 6) 모델 성능 향상
* 최적의 하이퍼 파라미터 값을 이용하기 위해, <strong>하이퍼파라미터 튜닝</strong> 진행<br><br>
* 노이즈 값을 없애고자, <strong>K-Fold 교차 검증</strong> 진행<br><br>

# 💻 예측결과
### 1) 역별 예측 결과
<h3 align="left"><img src="https://github.com/heegu0513/project/assets/100845169/d9dee8db-28bb-4b96-987a-58804a27577a" width = 1000px height = 400px></h3>

* 현재 9호선 역별 일평균 수요 승객은 2.7만명
* 길동생태공원, 명일공원역은 비교적 원활
* 샘터공원역은 9호선 일평균 수치와 비슷
* 고덕역은 다양한 인프라가 형성되어 있어 약 3.8만명으로 1일 승하차 평균을 크게 넘어 유동인구 혼잡 예상<br><br>

### 2) 혼잡률
<h3 align="center"><img src="https://github.com/heegu0513/project/assets/100845169/5a96a96b-6bd2-4631-b13d-e9889ef4a96c" width = 500px height = 300px></h3>
  
* 고덕역 예측 수요 약 3.8만명
* 고덕역 혼잡률 200% 이상  
* 고덕역의 승하차 수요와 현재 환승역임을 감안하여 급행역으로 선정<br><br>

# 📍 9호선 신설역 그룹화
### 1) 업무주거 그룹 : 길동생태공원, 명일공원역, 고덕역
* <strong>길동생태공원</strong>의 경우 시점역, 천호대로와 동남부 교차로 및 주변의 공원과 더불어 아파트가 밀집<br><br>
* <strong>명일공원역</strong>의 경우 중,고등학교 등 각종 교육시설과 일반 주택 및 아파트가 밀집<br><br> 
* <strong>고덕역</strong>의 경우 고등학교, 병원, 아파트 등 각종 교육 시설이 밀집<br><br> 
* <strong>따라서 길동생태공원, 명일공원역, 고덕역은 업무주거 그룹에 해당</strong><br><br>

### 2) 상업그룹 : 샘터공원역
* <strong>샘터공원역</strong>의 경우엔 고덕 강일 공공주택 1지구가 위치해있고, 고덕비즈밸리 중심 상업지역에 위치<br><br> 
* <strong>따라서 샘터공원역은 상업그룹에 해당</strong><br><br>

# 🚩 정책 제안
### 1) 대각선 신호등 설치
* 대각선 신호등을 설치하지 않으면 유동인구가 많은 지하철역에서 사람들이 몰리는 현상이 발생할 것
* 그러면 공간부족으로 차도에 발을 딛는 사람들이 점점 늘어날 것이고 그들의 안전은 보장할 수 없음 
* 그렇기 때문에 다른 역에 비해 수요승객수가 가장 많은 고덕역의 경우, <strong>사람들이 원활하게 이동할 수 있는 대각선 신호등 배치를 한다면 교통 및 혼잡한 상황을 예방할 수 있을 것으로 예상됨</strong>

### 2) 급행역 선정
* 승하차 수요는 중요한 고려사항이며 고덕역의 경우 환승노선이 2개인 점과, 예측승객수가 3만 명을 넘는 것을 감안했을 때, <strong>급행역으로 선정이 되는 것이 9호선 내부의 혼잡도를 예방할 수 있는 방안임</strong>

### 3) 도심 공동화 예방
* 도시가 성장하면서 땅값이 오르고, 그로인해 상업 시설들이 다수를 차지하게 됨
* 상업 시설의 특성상 상주인구는 매우 적은 대신 유동 인구가 많은 편
* 결국, 도심의 상주인구는 줄어들게 되는데, 이를 예방하기 위해 <strong>상업그룹에 해당하는 고덕역과 샘터 공원역 주변에 신축되는 고층건물에 대해서는 일정비용을 주거 용도로 하여 직장과 주거지가 이웃하도록 짓는다면, 도심공동화 현상을 예방할 수 있을 것으로 예상됨</strong>

### 4) 8량 추진화
* 9호선의 수요승객이 하루 평균 69만 명에서 약 78만 명으로 늘어남 
* 9호선의 지하 박스 구조물 자체는 8량 길이에 맞추어져 있어 신호, 전기, 승강장, 마감, 조명 등 공사를 진행 할 경우 막대한 예산이 들어감
* 9호선 승강장은 최대 8량까지 운행할 수 있도록 설계됐지만 제대로 활용하지 못하고 있음
* 위 예측결과는 9호선 8량화 추진에 힘을 실어줄 수 있는 근거로 활용될 수 있음

### 5) 적절한 출입구 입지 선정
* 지하철 이용의 혼잡도 문제는 단순히 지하철 내부의 현상을 넘어서, 외부로까지 이어짐 
* 위에 언급한 대각선 신호의 문제와 더불어, <strong>출입구의 적절한 위치 선정은 매우 중요한 사항에 해당</strong>
